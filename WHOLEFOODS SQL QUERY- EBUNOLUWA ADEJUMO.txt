 use ddmban_sql_analysis;--- SELECTING ALL DATA FROM THE DATA BASESELECT *FROM ddmban_data;--- SELECTING CATEGORY AND SUBCATEGORY IN ID '96'SELECT *FROM ddmban_dataWHERE ID = '96';--- selecting dietary factors that does not contain the nutrientSELECT     ID, product, category, subcategory, vegan, glutenfree,ketofriendly,vegetarian,organic,dairyfree,sugarconscious,paleofriendly,wholefoodsdiet,lowsodium,kosher,lowfat,engine2, PRICE   from  ddmban_data   WHERE vegan = '0'    AND glutenfree = '0'    AND ketofriendly = '0'    AND vegetarian = '0'    AND organic = '0'    AND dairyfree = '0'    AND sugarconscious = '0'    AND paleofriendly = '0'    AND wholefoodsdiet = '0'    AND lowsodium = '0'    AND kosher = '0'    AND lowfat = '0'    AND engine2 = '0';        ---- selecting the maximum price of product with koesher dietary factor    SELECT max(price) as highest_price, product, category, subcategory    FROM ddmban_data    WHERE kosher = '1'    GROUP BY product, category, subcategory    ORDER BY highest_price DESC;                        --- selecting the correlation between dietary factors and priceSelect category, subcategory, --- correlation between vegan  and Prices Round((Count(*)*Sum(vegan*price)-Sum(vegan)*Sum(price))/         (sqrt(Count(*)*Sum(vegan*vegan)-Sum(vegan)*Sum(vegan))*          sqrt(Count(*)*Sum(price*price)-Sum(price)*Sum(price))),2) AS veg_Correl,                              --- correlation between vegetarian  and Prices           Round((Count(*)*Sum(vegetarian*price)-Sum(vegetarian)*Sum(price))/         (sqrt(Count(*)*Sum(vegetarian*vegetarian)-Sum(vegetarian)*Sum(vegetarian))*          sqrt(Count(*)*Sum(price*price)-Sum(price)*Sum(price))),2) AS vegetarian_Correl,                              --- correlation between lowfat  and Prices            Round((Count(*)*Sum(lowfat*price)-Sum(lowfat)*Sum(price))/         (sqrt(Count(*)*Sum(lowfat*lowfat)-Sum(lowfat)*Sum(lowfat))*          sqrt(Count(*)*Sum(price*price)-Sum(price)*Sum(price))),2) AS lowfat_Correl,                              --- correlation between lowsodium  and Prices           Round((Count(*)*Sum(lowsodium*price)-Sum(lowsodium)*Sum(price))/         (sqrt(Count(*)*Sum(lowsodium*lowsodium)-Sum(lowsodium)*Sum(lowsodium))*          sqrt(Count(*)*Sum(price*price)-Sum(price)*Sum(price))),2) AS lowsodium_Correl,                              --- correlation between ketofriendly  and Prices             Round((Count(*)*Sum(ketofriendly*price)-Sum(ketofriendly)*Sum(price))/         (sqrt(Count(*)*Sum(ketofriendly*ketofriendly)-Sum(ketofriendly)*Sum(lowfat))*          sqrt(Count(*)*Sum(price*price)-Sum(price)*Sum(price))),2) AS ketofriendly_Corr,                	--- correlation between kosher  and Prices         Round((Count(*)*Sum(kosher*price)-Sum(kosher)*Sum(price))/         (sqrt(Count(*)*Sum(kosher*kosher)-Sum(kosher)*Sum(kosher))*          sqrt(Count(*)*Sum(price*price)-Sum(price)*Sum(price))),2) AS kosher_Correl,                                      --- correlation between engine2  and Prices              Round((Count(*)*Sum(engine2*price)-Sum(engine2)*Sum(price))/         (sqrt(Count(*)*Sum(engine2*engine2)-Sum(engine2)*Sum(engine2))*          sqrt(Count(*)*Sum(price*price)-Sum(price)*Sum(price))),2) AS engine2_Correl,                                  --- correlation between paleofriendly  and Prices             Round((Count(*)*Sum(paleofriendly*price)-Sum(paleofriendly)*Sum(price))/         (sqrt(Count(*)*Sum(paleofriendly*paleofriendly)-Sum(paleofriendly)*Sum(paleofriendly))*          sqrt(Count(*)*Sum(price*price)-Sum(price)*Sum(price))),2) AS paleofriendly_Correl,                                                    --- correlation between wholefoodsdiet  and Prices                         Round((Count(*)*Sum(wholefoodsdiet*price)-Sum(wholefoodsdiet)*Sum(price))/         (sqrt(Count(*)*Sum(wholefoodsdiet*wholefoodsdiet)-Sum(wholefoodsdiet)*Sum(wholefoodsdiet))*          sqrt(Count(*)*Sum(price*price)-Sum(price)*Sum(price))),2) AS wholefoodsdiet_Correl,                              --- correlation between diaryfree  and Prices          Round((Count(*)*Sum(dairyfree*price)-Sum(dairyfree)*Sum(price))/         (sqrt(Count(*)*Sum(dairyfree*dairyfree)-Sum(dairyfree)*Sum(dairyfree))*          sqrt(Count(*)*Sum(price*price)-Sum(price)*Sum(price))),2) AS dairyfree_Correl,                                  --- correlation between organic  and Prices            Round((Count(*)*Sum(organic*organic)-Sum(organic)*Sum(price))/         (sqrt(Count(*)*Sum(organic*organic)-Sum(organic)*Sum(organic))*          sqrt(Count(*)*Sum(price*price)-Sum(price)*Sum(price))),2) AS organic_Correl,                              --- correlation between sugarconscious and Prices            Round((Count(*)*Sum(sugarconscious*price)-Sum(sugarconscious)*Sum(price))/         (sqrt(Count(*)*Sum(sugarconscious*sugarconscious)-Sum(sugarconscious)*Sum(sugarconscious))*          sqrt(Count(*)*Sum(price*price)-Sum(price)*Sum(price))),2) AS sugarconscious_Correl,                    --- correlation between glutenfree  and Prices           Round((Count(*)*Sum(glutenfree*price)-Sum(glutenfree)*Sum(price))/         (sqrt(Count(*)*Sum(glutenfree*glutenfree)-Sum(glutenfree)*Sum(glutenfree))*          sqrt(Count(*)*Sum(price*price)-Sum(price)*Sum(price))),2) AS glutenfree_Correl                           FROM ddmban_data          group by category,subcategory;          -- Selecting correlation values between diet columns and price using the case statementSelect category, subcategory, --- correlation between vegan  and Prices Round((Count(*)*Sum(vegan*price)-Sum(vegan)*Sum(price))/         (sqrt(Count(*)*Sum(vegan*vegan)-Sum(vegan)*Sum(vegan))*          sqrt(Count(*)*Sum(price*price)-Sum(price)*Sum(price))),2) AS vegan_Correl,                   --- correlation between vegetarian and Prices           Round((Count(*)*Sum(vegetarian*price)-Sum(vegetarian)*Sum(price))/         (sqrt(Count(*)*Sum(vegetarian*vegetarian)-Sum(vegetarian)*Sum(vegetarian))*          sqrt(Count(*)*Sum(price*price)-Sum(price)*Sum(price))),2) AS vegetarian_Correl,                  --- correlation between lowfat and Prices            Round((Count(*)*Sum(lowfat*price)-Sum(lowfat)*Sum(price))/         (sqrt(Count(*)*Sum(lowfat*lowfat)-Sum(lowfat)*Sum(lowfat))*          sqrt(Count(*)*Sum(price*price)-Sum(price)*Sum(price))),2) AS lowfat_Correl,              --- correlation between lowsodium and Prices           Round((Count(*)*Sum(lowsodium*price)-Sum(lowsodium)*Sum(price))/         (sqrt(Count(*)*Sum(lowsodium*lowsodium)-Sum(lowsodium)*Sum(lowsodium))*          sqrt(Count(*)*Sum(price*price)-Sum(price)*Sum(price))),2) AS lowsodium_Correl,                    --- correlation between ketofriendly and Prices             Round((Count(*)*Sum(ketofriendly*price)-Sum(ketofriendly)*Sum(price))/         (sqrt(Count(*)*Sum(ketofriendly*ketofriendly)-Sum(ketofriendly)*Sum(lowfat))*          sqrt(Count(*)*Sum(price*price)-Sum(price)*Sum(price))),2) AS ketofriendly_Correl,               --- correlation between kosher and Prices         Round((Count(*)*Sum(kosher*price)-Sum(kosher)*Sum(price))/         (sqrt(Count(*)*Sum(kosher*kosher)-Sum(kosher)*Sum(kosher))*          sqrt(Count(*)*Sum(price*price)-Sum(price)*Sum(price))),2) AS kosher_Correl,                      --- correlation between engine2 and Prices              Round((Count(*)*Sum(engine2*price)-Sum(engine2)*Sum(price))/         (sqrt(Count(*)*Sum(engine2*engine2)-Sum(engine2)*Sum(engine2))*          sqrt(Count(*)*Sum(price*price)-Sum(price)*Sum(price))),2) AS engine2_Correl,                   --- correlation between paleofriendly and Prices             Round((Count(*)*Sum(paleofriendly*price)-Sum(paleofriendly)*Sum(price))/         (sqrt(Count(*)*Sum(paleofriendly*paleofriendly)-Sum(paleofriendly)*Sum(paleofriendly))*          sqrt(Count(*)*Sum(price*price)-Sum(price)*Sum(price))),2) AS paleofriendly_Correl,                  --- correlation between wholefoodsdiet and Prices                       Round((Count(*)*Sum(wholefoodsdiet*price)-Sum(wholefoodsdiet)*Sum(price))/         (sqrt(Count(*)*Sum(wholefoodsdiet*wholefoodsdiet)-Sum(wholefoodsdiet)*Sum(wholefoodsdiet))*          sqrt(Count(*)*Sum(price*price)-Sum(price)*Sum(price))),2) AS wholefoodsdiet_Correl,                   --- correlation between diary free and Prices          Round((Count(*)*Sum(dairyfree*price)-Sum(dairyfree)*Sum(price))/         (sqrt(Count(*)*Sum(dairyfree*dairyfree)-Sum(dairyfree)*Sum(dairyfree))*          sqrt(Count(*)*Sum(price*price)-Sum(price)*Sum(price))),2) AS dairyfree_Correl,                 --- correlation between organic and Prices          Round((Count(*)*Sum(organic*price)-Sum(organic)*Sum(price))/         (sqrt(Count(*)*Sum(organic*organic)-Sum(organic)*Sum(organic))*          sqrt(Count(*)*Sum(price*price)-Sum(price)*Sum(price))),2) AS organic_Correl,                    --- correlation between sugarconscious and Prices          Round((Count(*)*Sum(sugarconscious*price)-Sum(sugarconscious)*Sum(price))/         (sqrt(Count(*)*Sum(sugarconscious*sugarconscious)-Sum(sugarconscious)*Sum(sugarconscious))*          sqrt(Count(*)*Sum(price*price)-Sum(price)*Sum(price))),2) AS sugarconscious_Correl,                   --- correlation between glutenfree and Prices          Round((Count(*)*Sum(glutenfree*price)-Sum(glutenfree)*Sum(price))/         (sqrt(Count(*)*Sum(glutenfree*glutenfree)-Sum(glutenfree)*Sum(glutenfree))*          sqrt(Count(*)*Sum(price*price)-Sum(price)*Sum(price))),2) AS glutenfree_Correl,          --- case to show how suitables the no. of points are for correlation         case          when count(subcategory) <= 2 then 'Few data points for correlation'          Else 'Enough Data for correlation'          End as Data_Number_points                    from ddmban_data           where price != 0                                                    and category != 'NULL'                                              and (select count(subcategory) from ddmban_data) > 1             group by category,subcategory ;            